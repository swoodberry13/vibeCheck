<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
<style>
* {box-sizing: border-box;}

</style>
</head>
<body>

<div class="header">
  <div class="container" style = "display:flex; justify-content: space-between;">
    <div style = "display:flex;">
        <img src = "images/vibecheck_logo_large.png" width = 90px;>
        <h1>vibeCheck</h1>
    </div>

    <div class="header-right" style = "float: right;">
        <!-- <a class="active" href="#home">Home</a> -->
        <a href="main.html">Home</a>
        <a href="concerts.html">Concerts</a>
        <a href="results.html">Results</a>
        <a href="profile.html">Profile</a>
      </div>
  </div>

</div>

<p>Find concerts you love near you!</p>

<br><br>
<center>
  <button id="loginButton">Login with Spotify</button>
</center>


  <script>
    var client_id = '87587e4116394731a7ffbfb872d45712';//'daeea42af07e4702905904f246591317';
    var redirect_uri = 'https://swoodberry13.github.io/vibeCheck/results.html';
    var scopes = 'user-top-read playlist-read-private user-read-recently-played';
            document.getElementById('loginButton').addEventListener('click', function() {
            var authUrl = 'https://accounts.spotify.com/authorize?response_type=token&client_id='
             + client_id + '&scope=' + encodeURIComponent(scopes)+'&redirect_uri=' + encodeURIComponent(redirect_uri);
            window.location.href = authUrl;
        });

        // Function to extract code from URL after redirection
        function getCodeFromUrl() {
            var urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('code');
        }
        function getAccessTokenFromURL(){
          var urlParams = new URLSearchParams(window.location.search);
         
          return  urlParams.get('access_token');
        }

        // Once the page loads, extract the code from URL and redirect to results.html
        window.onload = function() {
            var code = getCodeFromUrl();
            var code2 = getAccessTokenFromURL()
            if (code) {
                // Redirect to results.html with the code as a query parameter
                window.location.href = 'results.html?access_token='+encodeURIComponent(code2);
            }
        };
  </script>

<div class="footer"></div>

</body>
</html>